# é’‰é’‰æ‰“å¡æé†’ç³»ç»Ÿ

ä¸€ä¸ªåŸºäºWebçš„é’‰é’‰æ‰“å¡æé†’ç³»ç»Ÿï¼Œæ”¯æŒæ’ç­ç®¡ç†ã€ç­æ¬¡é…ç½®ã€å®šæ—¶æé†’ç­‰åŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹æ€§

- âœ… **ç”¨æˆ·è®¤è¯ç³»ç»Ÿ** - æ”¯æŒå¤šç”¨æˆ·ç™»å½•å’Œæƒé™ç®¡ç†
- âœ… **æ’ç­ç®¡ç†** - å¯è§†åŒ–æ’ç­è¡¨ï¼Œæ”¯æŒæ‰¹é‡åˆ›å»ºå’Œå¯¼å…¥
- âœ… **ç­æ¬¡é…ç½®** - çµæ´»çš„ç­æ¬¡ç±»å‹è®¾ç½®ï¼Œæ”¯æŒè‡ªå®šä¹‰æ—¶é—´å’Œé¢œè‰²
- âœ… **å®šæ—¶æé†’** - æ ¹æ®æ’ç­è‡ªåŠ¨å‘é€ä¸Šä¸‹ç­æ‰“å¡æé†’
- âœ… **é€šçŸ¥é›†æˆ** - æ”¯æŒé’‰é’‰å’Œé£ä¹¦åŒå¹³å°é€šçŸ¥
- âœ… **æ—¥å¿—è®°å½•** - å®Œæ•´çš„æ“ä½œæ—¥å¿—å’Œè€ƒå‹¤è®°å½•
- âœ… **å“åº”å¼è®¾è®¡** - æ”¯æŒPCå’Œç§»åŠ¨ç«¯è®¿é—®
- âœ… **Dockeræ”¯æŒ** - ä¸€é”®éƒ¨ç½²ï¼Œæ”¯æŒARM64æ¶æ„
- âœ… **CI/CDé›†æˆ** - è‡ªåŠ¨åŒ–æ„å»ºå’Œéƒ¨ç½²

## æŠ€æœ¯æ ˆ

### åç«¯
- **Flask** - Webæ¡†æ¶
- **SQLAlchemy** - ORMæ¡†æ¶
- **Flask-Login** - ç”¨æˆ·è®¤è¯
- **APScheduler** - å®šæ—¶ä»»åŠ¡
- **Requests** - HTTPè¯·æ±‚åº“

### å‰ç«¯
- **Bootstrap 5** - CSSæ¡†æ¶
- **jQuery** - JavaScriptåº“
- **FullCalendar** - æ—¥å†ç»„ä»¶
- **DataTables** - è¡¨æ ¼ç»„ä»¶

### æ•°æ®åº“
- **SQLite** - è½»é‡çº§æ•°æ®åº“

### éƒ¨ç½²
- **Docker** - å®¹å™¨åŒ–éƒ¨ç½²
- **GitHub Actions** - CI/CDè‡ªåŠ¨åŒ–

## å¿«é€Ÿå¼€å§‹

### 1. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/yourusername/dingding-attendance-system.git
cd dingding-attendance-system
```

### 2. ç¯å¢ƒé…ç½®

```bash
# å¤åˆ¶ç¯å¢ƒé…ç½®æ–‡ä»¶
cp .env.example .env

# ç¼–è¾‘é…ç½®æ–‡ä»¶
vim .env
```

### 3. Dockeréƒ¨ç½²

```bash
# ä½¿ç”¨Docker Composeå¯åŠ¨
docker-compose up -d

# æˆ–è€…ä½¿ç”¨Dockerç›´æ¥è¿è¡Œ
docker build -t dingding-attendance .
docker run -d -p 5000:5000 --name dingding-app dingding-attendance
```

### 4. æœ¬åœ°å¼€å‘

```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv
source venv/bin/activate  # Linux/Mac
# venv\Scripts\activate  # Windows

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# åˆå§‹åŒ–æ•°æ®åº“
python run.py init_db

# åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·
python run.py create_admin

# å¯åŠ¨åº”ç”¨
python run.py
```

## é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡

| å˜é‡å | è¯´æ˜ | é»˜è®¤å€¼ |
|--------|------|--------|
| `SECRET_KEY` | Flaskå¯†é’¥ | éšæœºç”Ÿæˆ |
| `DATABASE_URL` | æ•°æ®åº“è¿æ¥ | sqlite:///data/app.db |
| `API_TOKEN` | APIè®¿é—®ä»¤ç‰Œ | ç©º |
| `CHECK_URL` | æ‰“å¡æ£€æµ‹APIåœ°å€ | ç©º |
| `WORKING_URL` | ä¸Šç­æé†’Webhook | ç©º |
| `NO_WORK_URL` | ä¸‹ç­æé†’Webhook | ç©º |
| `WORK_OVERTIME` | åŠ ç­æ—¶é—´(åˆ†é’Ÿ) | 0 |
| `REMINDER_ENABLED` | å¯ç”¨æé†’åŠŸèƒ½ | true |

### é»˜è®¤è´¦å·

ç³»ç»Ÿåˆå§‹åŒ–åä¼šåˆ›å»ºé»˜è®¤ç®¡ç†å‘˜è´¦å·ï¼š
- **ç”¨æˆ·å**: admin
- **å¯†ç **: admin123

**âš ï¸ é‡è¦**: é¦–æ¬¡ç™»å½•åè¯·ç«‹å³ä¿®æ”¹é»˜è®¤å¯†ç ï¼

## ä½¿ç”¨è¯´æ˜

### 1. ç³»ç»Ÿé…ç½®

ç™»å½•åé¦–å…ˆé…ç½®ç³»ç»Ÿå‚æ•°ï¼š
1. è¿›å…¥"ç³»ç»Ÿé…ç½®"é¡µé¢
2. è®¾ç½®APIè®¿é—®ä»¤ç‰Œå’ŒWebhookåœ°å€
3. é…ç½®åŠ ç­æ—¶é—´å’Œæé†’å¼€å…³

### 2. ç­æ¬¡ç®¡ç†

1. è¿›å…¥"ç­æ¬¡ç®¡ç†"é¡µé¢
2. åˆ›å»ºéœ€è¦çš„ç­æ¬¡ç±»å‹ï¼ˆå¦‚ï¼šAç­ã€Bç­ç­‰ï¼‰
3. è®¾ç½®ç­æ¬¡çš„å¼€å§‹æ—¶é—´ã€ç»“æŸæ—¶é—´å’Œæ˜¾ç¤ºé¢œè‰²

### 3. æ’ç­ç®¡ç†

1. è¿›å…¥"æ’ç­ç®¡ç†"é¡µé¢
2. ç‚¹å‡»"åˆ›å»ºæ’ç­"ä¸ºæ¯ä¸ªç”¨æˆ·è®¾ç½®æ’ç­
3. æˆ–ä½¿ç”¨"æ‰¹é‡åˆ›å»º"åŠŸèƒ½å¿«é€Ÿç”Ÿæˆæ’ç­è¡¨
4. åœ¨"æ’ç­æ—¥å†"ä¸­æŸ¥çœ‹æ•´ä½“æ’ç­æƒ…å†µ

### 4. å®šæ—¶æé†’

ç³»ç»Ÿä¼šæ ¹æ®æ’ç­è¡¨è‡ªåŠ¨æ£€æŸ¥æ‰“å¡çŠ¶æ€ï¼š
- **ä¸Šç­æé†’**: ä¸Šç­å‰15åˆ†é’Ÿå‘é€
- **ä¸‹ç­æé†’**: ä¸‹ç­å30åˆ†é’Ÿå‘é€ï¼ˆåŒ…å«åŠ ç­æ—¶é—´ï¼‰

## APIæ¥å£

ç³»ç»Ÿæä¾›RESTful APIæ¥å£ï¼Œæ–¹ä¾¿ç¬¬ä¸‰æ–¹é›†æˆï¼š

### ç”¨æˆ·ç®¡ç†
- `GET /api/users` - è·å–ç”¨æˆ·åˆ—è¡¨
- `GET /api/shift-types` - è·å–ç­æ¬¡ç±»å‹

### ç³»ç»ŸçŠ¶æ€
- `GET /api/scheduler/status` - è·å–è°ƒåº¦å™¨çŠ¶æ€
- `POST /api/scheduler/start` - å¯åŠ¨å®šæ—¶ä»»åŠ¡
- `POST /api/scheduler/stop` - åœæ­¢å®šæ—¶ä»»åŠ¡

### é…ç½®ç®¡ç†
- `GET /api/config/<key>` - è·å–é…ç½®
- `PUT /api/config/<key>` - æ›´æ–°é…ç½®

## éƒ¨ç½²æŒ‡å—

### Dockeréƒ¨ç½²

```bash
# æ„å»ºé•œåƒ
docker build -t dingding-attendance:latest .

# è¿è¡Œå®¹å™¨
docker run -d \
  --name dingding-app \
  -p 5000:5000 \
  -v $(pwd)/data:/app/data \
  -v $(pwd)/logs:/app/logs \
  -e SECRET_KEY=your-secret-key \
  -e API_TOKEN=your-api-token \
  dingding-attendance:latest
```

### Docker Composeéƒ¨ç½²

```bash
# å¯åŠ¨æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f web

# åœæ­¢æœåŠ¡
docker-compose down
```

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

1. **ä½¿ç”¨Gunicorn**:
```bash
gunicorn --bind 0.0.0.0:5000 --workers 4 run:app
```

2. **ä½¿ç”¨Nginxåå‘ä»£ç†**:
``nginx
server {
    listen 80;
    server_name your-domain.com;
    
    location / {
        proxy_pass http://127.0.0.1:5000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}
```

### ARM64æœåŠ¡å™¨éƒ¨ç½²

æœ¬é¡¹ç›®åŸç”Ÿæ”¯æŒARM64æ¶æ„ï¼Œå¯åœ¨æ ‘è“æ´¾ã€AWS Gravitonç­‰ARM64æœåŠ¡å™¨ä¸Šéƒ¨ç½²ã€‚

è¯¦ç»†éƒ¨ç½²æŒ‡å—è¯·å‚è€ƒ [ARM64éƒ¨ç½²æŒ‡å—](DEPLOYMENT_ARM64.md)

## å¼€å‘æŒ‡å—

### é¡¹ç›®ç»“æ„

```
â”œâ”€â”€ app/                    # åº”ç”¨ä»£ç 
â”‚   â”œâ”€â”€ models.py          # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ routes/            # è·¯ç”±æ¨¡å—
â”‚   â”œâ”€â”€ forms/             # è¡¨å•éªŒè¯
â”‚   â”œâ”€â”€ templates/         # HTMLæ¨¡æ¿
â”‚   â””â”€â”€ utils/             # å·¥å…·æ¨¡å—
â”œâ”€â”€ static/                # é™æ€æ–‡ä»¶
â”œâ”€â”€ data/                  # æ•°æ®æ–‡ä»¶
â”œâ”€â”€ logs/                  # æ—¥å¿—æ–‡ä»¶
â”œâ”€â”€ docker/                # Dockeré…ç½®
â”œâ”€â”€ migrations/            # æ•°æ®åº“è¿ç§»
â”œâ”€â”€ tests/                 # æµ‹è¯•ä»£ç 
â””â”€â”€ requirements.txt       # ä¾èµ–åˆ—è¡¨
```

### æ·»åŠ æ–°åŠŸèƒ½

1. **åˆ›å»ºæ•°æ®æ¨¡å‹** - åœ¨ `app/models.py` ä¸­å®šä¹‰
2. **åˆ›å»ºè¡¨å•éªŒè¯** - åœ¨ `app/forms/` ç›®å½•ä¸­æ·»åŠ 
3. **åˆ›å»ºè·¯ç”±** - åœ¨ `app/routes/` ç›®å½•ä¸­æ·»åŠ 
4. **åˆ›å»ºæ¨¡æ¿** - åœ¨ `app/templates/` ç›®å½•ä¸­æ·»åŠ 
5. **æ·»åŠ é™æ€æ–‡ä»¶** - åœ¨ `static/` ç›®å½•ä¸­æ·»åŠ 

### ä»£ç è§„èŒƒ

- ä½¿ç”¨UTF-8ç¼–ç 
- éµå¾ªPEP 8 Pythonç¼–ç è§„èŒƒ
- å‡½æ•°å’Œå˜é‡ä½¿ç”¨è‹±æ–‡å‘½å
- æ³¨é‡Šå’Œæ–‡æ¡£ä½¿ç”¨ä¸­æ–‡

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **ä¸­æ–‡ä¹±ç é—®é¢˜**
   - ç¡®ä¿æ‰€æœ‰æ–‡ä»¶ä½¿ç”¨UTF-8ç¼–ç 
   - æ£€æŸ¥æ•°æ®åº“å­—ç¬¦é›†è®¾ç½®

2. **å®šæ—¶ä»»åŠ¡ä¸æ‰§è¡Œ**
   - æ£€æŸ¥ `REMINDER_ENABLED` é…ç½®
   - ç¡®è®¤APIé…ç½®æ˜¯å¦æ­£ç¡®
   - æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—è·å–è¯¦ç»†ä¿¡æ¯

3. **é€šçŸ¥å‘é€å¤±è´¥**
   - æ£€æŸ¥ç½‘ç»œè¿æ¥
   - éªŒè¯Webhookåœ°å€æ˜¯å¦æ­£ç¡®
   - ç¡®è®¤APIä»¤ç‰Œæ˜¯å¦æœ‰æ•ˆ

4. **Dockeréƒ¨ç½²å¤±è´¥**
   - æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨
   - ç¡®è®¤æ•°æ®å·æƒé™
   - æŸ¥çœ‹å®¹å™¨æ—¥å¿—

### æ—¥å¿—æŸ¥çœ‹

```bash
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
tail -f logs/app.log

# æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—
journalctl -u your-service-name

# Dockeræ—¥å¿—
docker logs -f dingding-app
```

## è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥æ”¹è¿›é¡¹ç›®ï¼

### å¼€å‘æµç¨‹

1. Forké¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»ºPull Request

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## æ›´æ–°æ—¥å¿—

### v1.0.0 (2024-09-25)
- âœ¨ åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- ğŸš€ æ”¯æŒç”¨æˆ·è®¤è¯å’Œæƒé™ç®¡ç†
- ğŸ“… æ’ç­ç®¡ç†åŠŸèƒ½
- â° å®šæ—¶æé†’åŠŸèƒ½
- ğŸ³ Dockeræ”¯æŒ
- ğŸ”„ CI/CDé›†æˆ

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿è”ç³»ï¼š
- æäº¤Issue: [GitHub Issues](https://github.com/yourusername/dingding-attendance-system/issues)
- é‚®ç®±: your.email@example.com

---

**äº«å—ä½¿ç”¨é’‰é’‰æ‰“å¡æé†’ç³»ç»Ÿï¼** ğŸ‰